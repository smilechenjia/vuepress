{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{263:function(t,e,a){t.exports=a.p+\"assets/img/index.32a8fd39.png\"},264:function(t,e,a){t.exports=a.p+\"assets/img/regist.bfbf2c12.png\"},265:function(t,e,a){t.exports=a.p+\"assets/img/login1.fffb1fb6.png\"},266:function(t,e,a){t.exports=a.p+\"assets/img/login2.137677a3.png\"},267:function(t,e,a){t.exports=a.p+\"assets/img/realtime.9dc8f765.png\"},274:function(t,e,a){\"use strict\";a.r(e);var n=a(38),i=Object(n.a)({},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[n(\"h1\",{attrs:{id:\"人脸识别前端-demo\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#人脸识别前端-demo\",\"aria-hidden\":\"true\"}},[t._v(\"#\")]),t._v(\" 人脸识别前端 demo\")]),t._v(\" \"),n(\"p\",[n(\"code\",[t._v(\"2019-11-18\")])]),t._v(\" \"),n(\"div\",{staticClass:\"tip custom-block\"},[n(\"p\",[t._v(\"本文使用h5、css、jquery做一个人脸识别前端demo，主要用于移动端。demo共有四个页面：首页、注册页、拍照登陆页、实时登陆页\")])]),t._v(\" \"),n(\"h2\",{attrs:{id:\"demo使用\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#demo使用\",\"aria-hidden\":\"true\"}},[t._v(\"#\")]),t._v(\" demo使用\")]),t._v(\" \"),n(\"ol\",[n(\"li\",[t._v(\"进入demo就是首页，首页有三个引导框，点击进入其他页面\")])]),t._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:a(263),alt:\"avatar\"}})]),t._v(\" \"),n(\"ol\",{attrs:{start:\"2\"}},[n(\"li\",[t._v(\"进入注册页\\n点击首页的“注册”即可跳转到注册页，注册页采用人脸注册方式，上传人脸的方式是使用拍照功能或者直接从相册里选择。在上传好照片后，demo会调用人脸检测接口，在照片上标出人脸轮廓。照片上传好以及信息填好后点击提交，demo会调用人脸注册接口，接口将照片存入后台图库，注册成功后跳转到首页\")])]),t._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:a(264),alt:\"avatar\"}})]),t._v(\" \"),n(\"ol\",{attrs:{start:\"3\"}},[n(\"li\",[t._v(\"进入拍照登陆页\\n在首页点击“拍照登陆”即可进入拍照登陆页，还是采用人脸登陆方式，上传人脸的方式是使用拍照功能或者直接从相册里选择。上传好照片后，demo会调用人脸检测接口，在照片上标出人脸轮廓。点击提交，demo会调用人脸检索接口，接口将上传的照片与后台图库进行对比，如果相似度大于90%就返回登陆成功。当登陆成功后，界面显示个人注册的信息。\")])]),t._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:a(265),alt:\"avatar\"}})]),t._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:a(266),alt:\"avatar\"}})]),t._v(\" \"),n(\"ol\",{attrs:{start:\"4\"}},[n(\"li\",[t._v(\"进入实时登陆页\\n在首页点击“实时登陆”进入实时登陆页，点击“开始识别”则开启摄像头，每两秒绘制图像并调用人脸检索接口，直至匹配成功，停止识别并返回注册的信息。识别中途用户点击“停止识别”也可以停止调用接口\")])]),t._v(\" \"),n(\"p\",[n(\"img\",{attrs:{src:a(267),alt:\"avatar\"}})]),t._v(\" \"),n(\"h2\",{attrs:{id:\"技术点拆分\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#技术点拆分\",\"aria-hidden\":\"true\"}},[t._v(\"#\")]),t._v(\" 技术点拆分\")]),t._v(\" \"),n(\"ol\",[n(\"li\",[t._v(\"实现上传照片：手机拍照或从相册选择\")])]),t._v(\" \"),n(\"p\",[t._v(\"方法：使用h5的input标签，type属性设置为file，accept属性设置为image/*\")]),t._v(\" \"),n(\"p\",[t._v(\"代码：\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v('html:\\n\\n<input id=\"file\" name=\"file\" type=\"file\" accept=\"image/*\"/>\\n')])])]),n(\"ol\",{attrs:{start:\"2\"}},[n(\"li\",[t._v(\"input file自带样式不满足要求\")])]),t._v(\" \"),n(\"p\",[t._v(\"方法：把input在页面上隐藏了，并且使用div自己定义一个“拍照”按钮的样式，当点击这个div时，调用input的点击事件\")]),t._v(\" \"),n(\"p\",[t._v(\"代码:\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v('html:\\n\\n<div id=\"cambtn\" class=\"btn\">拍照/相册</div> \\n<input id=\"file\" name=\"file\" type=\"file\" accept=\"image/*\"/>\\n')])])]),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"css:\\n\\n#file {\\n  display: none;\\n}\\n\\n#cambtn {\\n  /*自定义样式*/\\n}\\n\")])])]),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"javascript:\\n\\n$('#cambtn').click(function(){\\n  $('#file').click();\\n})\\n\")])])]),n(\"ol\",{attrs:{start:\"3\"}},[n(\"li\",[t._v(\"iphone手机拍照后照片会顺时针旋转90度，需要在调用接口前将照片正过来\")])]),t._v(\" \"),n(\"p\",[t._v(\"方法：使用exif.js和canvas\")]),t._v(\" \"),n(\"p\",[t._v(\"canvas绘制图像，利用它把图片逆时针旋转90度\")]),t._v(\" \"),n(\"p\",[t._v(\"exif可以读取拍摄的照片的具体信息，其中Orientation表示旋转角度，具体取值如下：\")]),t._v(\" \"),n(\"table\",[n(\"thead\",[n(\"tr\",[n(\"th\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"照片旋转角度\")]),t._v(\" \"),n(\"th\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"值\")])])]),t._v(\" \"),n(\"tbody\",[n(\"tr\",[n(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"0度\")]),t._v(\" \"),n(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"1\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"顺时针90度\")]),t._v(\" \"),n(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"6\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"逆时针90度\")]),t._v(\" \"),n(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"8\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"180度\")]),t._v(\" \"),n(\"td\",{staticStyle:{\"text-align\":\"center\"}},[t._v(\"3\")])])])]),t._v(\" \"),n(\"p\",[t._v(\"可以前往exif下载exif.js，之后在script标签中引用，当Orientation值为6时更正图片位置\")]),t._v(\" \"),n(\"p\",[t._v(\"代码：\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v('html:\\n\\n<input id=\"file\" name=\"file\" type=\"file\" accept=\"image/*\"/>    \\x3c!--上传照片--\\x3e\\n<canvas id=\"myCanvas\" style=\"display: none\"></canvas>   \\x3c!--辅助用--\\x3e\\n<img src=\"\" id=\"ago\" style=\"display: none;\"/>\\n\\n')])])]),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v('javascript:\\n\\nvar $files = document.querySelector(\"#file\");\\nvar file = $files.files[0];  //获取上传的照片\\nvar agoimg = document.querySelector(\"#ago\");//用于保存上传的原始图片\\nvar Orientation = null;\\n\\n//获得图片旋转角度\\nEXIF.getData(file, function() {\\n  Orientation = EXIF.getTag(this, \\'Orientation\\');\\n});\\nvar reader = new FileReader();  //创建filereader对象\\nreader.readAsDataURL(file);     //转换数据\\nreader.onload = function(e){    //加载成功时触发的事件\\n  var image = new Image();\\n  image.src = e.target.result;\\n  agoimg.src = e.target.result;\\n  agoimg.onload = function() {\\n    var canvas = document.getElementById(\\'myCanvas\\');\\n    canvas.width = this.naturalWidth;\\n    canvas.height = this.naturalHeight;\\n    var ctx = canvas.getContext(\"2d\");\\n    //ios拍摄出来的照片：Orientation属性为6 \\n    if (Orientation === 6) {\\n      ctx.save(); //保存状态\\n      ctx.translate(canvas.width/2, canvas.height/2);  //设置画布上的(0,0)位置，也就是旋转的中心点\\n      ctx.rotate(90 * Math.PI / 180);  //把画布旋转90度\\n      //把图片绘制在画布translate之前的中心点\\n      ctx.drawImage(image, -(canvas.width/2), -(canvas.height/2), canvas.width, \\n      canvas.height);   \\n      ctx.restore();    //恢复状态\\n    }\\n    else {\\n      ctx.drawImage(image, 0, 0, canvas.width, canvas.height);\\n    }\\n    var base64 = null;\\n    base64 = canvas.toDataURL(\"image/jpeg\");  //转化成base64字符串\\n  }\\n}\\n         \\n')])])]),n(\"ol\",{attrs:{start:\"4\"}},[n(\"li\",[t._v(\"由于后台接口接收的图片的格式是二进制流的，所以需要把现有的base64字符串转化成二进制流\")])]),t._v(\" \"),n(\"p\",[t._v(\"解决方法：先把base64字符串解码，再把字符串中的每一个字符转化成Unicode编码，最后再基于此创建一个blob对象\")]),t._v(\" \"),n(\"p\",[t._v(\"代码：\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"javascript:\\n\\nvar bytes = window.atob((base64).split(',')[1]);   //字符串解码\\nvar array = [];\\nfor(var i = 0; i < bytes.length; i++){    //每一个字符转化成unicode编码\\n  array.push(bytes.charCodeAt(i));\\n}\\nvar blob = new Blob([new Uint8Array(array)],{type:'image/jpeg'}); //创建二进制流blob对象\\n\")])])]),n(\"p\",[t._v(\"5.调用摄像头实时识别\")]),t._v(\" \"),n(\"p\",[t._v(\"解决方法：使用navigator.mediaDevices.getUserMedia获取用户设备，并将视频流设置为video元素的源，最后使用canvas绘制video的成像\")]),t._v(\" \"),n(\"p\",[t._v(\"代码：\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v('html: \\n\\n<video id=\"video\" width=\"300\" height=\"300\" autoplay></video>\\n<canvas id=\"canvas\" style=\"display:none;\" width=\"300\" height=\"300\"></canvas>\\n')])])]),n(\"div\",{staticClass:\"language- extra-class\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v('javascript:\\n\\n\\nvar canvas = document.getElementById(\"canvas\");\\nvar context = canvas.getContext(\"2d\");\\nvar video = document.getElementById(\"video\");\\n\\nif (navigator.mediaDevices === undefined) {\\n  navigator.mediaDevices = {};\\n}\\n      \\nif (navigator.mediaDevices.getUserMedia === undefined) {\\n  navigator.mediaDevices.getUserMedia = function (constraints) {\\n    var getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\\n    if (!getUserMedia) {\\n      return Promise.reject(new Error(\\'getUserMedia is not implemented in this browser\\'));\\n    }\\n    return new Promise(function (resolve, reject) {\\n      getUserMedia.call(navigator, constraints, resolve, reject);\\n    });\\n  }\\n}\\nvar constraints = { audio: false, video: {width: 720,height:720} }\\nnavigator.mediaDevices.getUserMedia(constraints)\\n        .then(function (stream) {\\n          var video = document.querySelector(\\'video\\');\\n          if (\"srcObject\" in video) {\\n            video.srcObject = stream;\\n          } else {\\n            video.src = window.URL.createObjectURL(stream);\\n          }\\n          video.onloadedmetadata = function (e) {\\n            video.play();\\n          };\\n        })\\n        .catch(function (err) {\\n          console.log(err.name + \": \" + err.message);\\n        });\\n      \\ncontext.drawImage(video, 0, 0, 300, 300);\\n')])])]),n(\"blockquote\",[n(\"p\",[t._v(\"具体源代码可至\"),n(\"a\",{attrs:{href:\"https://github.com/smilechenjia/face\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"我的github\"),n(\"OutboundLink\")],1),t._v(\"查看\")])])])},[],!1,null,null,null);e.default=i.exports}}]);","extractedComments":[]}